var index=function(n,t){function r(t,r,u){n.ajax({dataType:"json",url:i+"?m="+t,data:r,success:u,cache:!1})}function u(n,i,r,u,f,e){var o=this;o.counterName=r,o.counterHelp=i,o.counterName=r,o.counterType=u,o.instanceName=f,o.hash=e,o.value=t.observable()}function f(){var n=this;n.rows=t.observableArray(),n.hashToRowIndex={},n.resizeGraph=!0,n.showGraph=t.observable(!1),n.showGraph.subscribe(function(t){t&&(n.resizeGraph=!0)})}function e(n,t,i){var r=this;r.name=n,r.doc=t,r.value=i}function o(n){var i=this;i.id=n,i.rows=t.observableArray()}function s(n){var i=this,r;for(i.rootObjects=[],i.chosenRootObject=t.observable(),i.performanceCounter=new f,i.goToRootObject=function(n){location.hash=n.id},i.showDashbord=function(){location.hash="#"},r=0;r<n.length;r++)i.rootObjects.push(new o(n[r]));i.chosenRootObject(i.rootObjects[0])}var i;return{init:function(f,o){var h,y;i=o,n(document).ajaxError(function(n,t,i,r){toastr.error(r,"Faild to fetch data")}),h=new s(f),t.applyBindings(h),y=Sammy(function(){this.get("#",function(){h.chosenRootObject(h.rootObjects[0]),h.performanceCounter.resizeGraph=!0}),this.get("#:rootObjectId",function(){for(var i=this.params.rootObjectId,n,t=0;t<h.rootObjects.length;t++)if(n=h.rootObjects[t],n.id==i){h.chosenRootObject(n),h.performanceCounter.resizeGraph=!0,n.rows().length||r("loadRootObject",{id:i},function(t){for(var i=0;i<t.length;i++)n.rows.push(new e(t[i].Name,t[i].Doc,t[i].Value))});return}this.redirect("#")}),this.get("",function(){this.app.runRoute("get","#")})}).run(),n(".footer-nav").click(function(){y.unload()}),n(document).ajaxSend(function(){n("#ajax-spinner").css("visibility","visible")}),n(document).ajaxComplete(function(){n("#ajax-spinner").css("visibility","hidden")});var p=n.connection.diagDashHub,w=!1,c=[],l=[],v=10,b,a=n.plot("#perf-counter-placeholder",l,{series:{shadowSize:0},yaxis:{min:0,max:100},xaxis:{mode:"time"},legend:{backgroundColor:"000000"}});p.client.updatePerformanceCounters=function(t,i){var f,r,u,e;if(w){for(f=[],e=(new Date).getTimezoneOffset()*6e4,r=0;r<i.length;r++){var o=h.performanceCounter.hashToRowIndex[i[r].Hash],s=i[r].Value,y=i[r].NormalizedValue;h.performanceCounter.rows()[o].value(s),f[o]=[t-e,y]}if(c.length===v&&(c=c.slice(1)),c.push(f),h.performanceCounter.showGraph()&&!h.chosenRootObject().id){for(r=0;r<l.length;r++){if(l[r].data=[],c.length<v)for(u=0;u<v-c.length;u++)l[r].data.push([t-e-(v-u)*b,0]);for(u=0;u<c.length;u++)l[r].data.push(c[u][r])}a.setData(l),h.performanceCounter.resizeGraph&&(a=n.plot("#perf-counter-placeholder",l,{series:{shadowSize:0},yaxis:{min:0,max:100},xaxis:{mode:"time"},legend:{backgroundColor:"000000"}}),a.resize(),h.performanceCounter.resizeGraph=!1),a.setupGrid(),a.draw()}}},n.connection.hub.start().fail(function(){toastr.error("Faild to start the hub","Signalr error")}).done(function(){p.server.getPerformanceCounters([]).done(function(n){if(n&&n.perfCounters&&n.perfCounters.length){for(var t=0;t<n.perfCounters.length;t++)h.performanceCounter.rows.push(new u(n.perfCounters[t].CategoryName,n.perfCounters[t].CounterHelp,n.perfCounters[t].CounterName,n.perfCounters[t].CounterType,n.perfCounters[t].InstanceName,n.perfCounters[t].Hash)),h.performanceCounter.hashToRowIndex[n.perfCounters[t].Hash]=t,l.push({label:n.perfCounters[t].CounterName,color:t,data:[]});b=n.snapshotMilliseconds,w=!0}})})}}}(jQuery,ko);
//@ sourceMappingURL=index.min.js.map